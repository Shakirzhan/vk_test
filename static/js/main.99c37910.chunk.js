(this.webpackJsonpcurrency=this.webpackJsonpcurrency||[]).push([[0],{115:function(e,t,r){e.exports=r(137)},134:function(e,t,r){},135:function(e,t,r){},136:function(e,t,r){},137:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r.n(n),c=r(19),o=r.n(c),u=r(14),i=r(33),s=r(32),l=r(43),h=r(44),m=[{name:"currency",path:"/currency"},{name:"about",path:"/about"}];var d=r(34),v=r.n(d),p=r(45),y=r.n(p),f=v()({currencyRates:void 0});function b(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case"currency_rates.CBR_DAILY_FETCHED":return e.merge({cbrDaily:t.daily});case"currency_rates.USD_EUR_RATE_FETCHED":return e.merge({usdEurRate:t.daily});default:return e}}function g(e){return e.currencyRates.cbrDaily}function C(e){return e.currencyRates.usdEurRate}function E(e){return e.currencyRates.cbrDaily?y.a.keyBy(e.currencyRates.cbrDaily.Valute,(function(e){return e.CharCode})):[]}var _=v()({vk:void 0});function w(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case"vk.accessTokenFetched":return e.merge({accessToken:t.accessToken});case"vk.notificationsStatusFetched":return e.merge({notificationStatus:t.notificationStatus});case"vk.insetsFetched":return e.merge({insets:t.insets});case"vk.accessTokenFailed":case"vk.notificationsStatusFailed":return e.merge({logs:t.error});default:return e}}function k(e){return e.vk.accessToken}function A(e){return e.vk.notificationStatus}function j(e){return e.vk.insets}function O(e){return JSON.stringify(e.vk.logs)}var R=r(27),S=r(38),x=r(46),D=r(47);var U=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function B(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var N=r(7),T=r(8),F=r(16),P=r(15),Q=r(4),I=(r(31),r(17)),M=r.n(I),W=r(25),K=r(40);var V=r(54),Y=r.n(V),H=r(55),Z=r.n(H),J=(r(134),r(56)),q=r.n(J),G=function(e){Object(F.a)(r,e);var t=Object(P.a)(r);function r(){return Object(N.a)(this,r),t.apply(this,arguments)}return Object(T.a)(r,[{key:"render",value:function(){return a.a.createElement(Q.d,{className:"footer"},a.a.createElement(Q.a,{level:"3",component:"a",target:"_blank",href:"https://vk.me/currency_app",before:a.a.createElement(q.a,null)}),a.a.createElement(Q.a,{level:"3",component:"a",target:"_blank",href:"https://vk.com/currency_app"},"\u0413\u0440\u0443\u043f\u043f\u0430"),a.a.createElement(Q.a,{level:"3",component:"a",onClick:this.openAbout.bind(this)},"\u041e \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u0435"))}},{key:"openAbout",value:function(){this.props.router.navigate("about")}}]),r}(n.Component);var L=Object(u.b)((function(e){return{}}))(G),X=function(e){Object(F.a)(r,e);var t=Object(P.a)(r);function r(){return Object(N.a)(this,r),t.apply(this,arguments)}return Object(T.a)(r,[{key:"render",value:function(){var e=Object(Q.p)();return a.a.createElement(Q.k,{id:this.props.id},a.a.createElement(Q.l,{left:a.a.createElement(Q.f,{onClick:this.navigationBack.bind(this)},e===Q.g?a.a.createElement(Y.a,null):a.a.createElement(Z.a,null))},"\u041e \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u0435"),a.a.createElement(Q.e,{title:"\u0418\u0441\u0445\u043e\u0434\u043d\u044b\u0439 \u043a\u043e\u0434"},a.a.createElement(Q.d,null,"\u0418\u0441\u0445\u043e\u0434\u043d\u044b\u0439 \u043a\u043e\u0434 \u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d \u043d\u0430 ",a.a.createElement(Q.i,{href:"https://github.com/tsivarev/currency"},"GitHub"),".",a.a.createElement("br",null),a.a.createElement("br",null),"\u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f ",a.a.createElement(Q.i,{href:"https://vk.com/dev/vk_apps_docs"},"VK Apps \u043f\u043b\u0430\u0442\u0444\u043e\u0440\u043c\u044b"),".")),a.a.createElement(Q.e,{title:"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u044b\u0435 \u0440\u0435\u0441\u0443\u0440\u0441\u044b"},a.a.createElement(Q.j,null,a.a.createElement(Q.b,{multiline:!0},"\u0418\u043a\u043e\u043d\u043a\u0438 \u2013 ",a.a.createElement(Q.i,{href:"https://www.flaticon.com/authors/smashicons"},"Smashicons"),". \u041b\u0438\u0446\u0435\u043d\u0437\u0438\u044f ",a.a.createElement(Q.i,{href:"http://creativecommons.org/licenses/by/3.0/"},"CC 3.0 BY"),"."),a.a.createElement(Q.b,{multiline:!0},"\u041a\u0443\u0440\u0441\u044b \u0426\u0411 \u0420\u0424 \u2013 ",a.a.createElement(Q.i,{href:"https://www.cbr-xml-daily.ru/"},"API"),"."),a.a.createElement(Q.b,{multiline:!0},"\u041a\u0443\u0440\u0441 USD/EUR \u2013 ",a.a.createElement(Q.i,{href:"https://free.currencyconverterapi.com/"},"API"),"."))),a.a.createElement(L,{router:this.props.router}))}},{key:"navigationBack",value:function(){this.props.router.navigate("currency")}}]),r}(n.Component);var z=Object(u.b)((function(e){return{}}))(X),$=(r(57),r(58)),ee=r.n($),te=r(20),re=(r(135),function(e){Object(F.a)(r,e);var t=Object(P.a)(r);function r(e){var n;return Object(N.a)(this,r),(n=t.call(this,e)).renderRow=n.renderRow.bind(Object(te.a)(n)),n}return Object(T.a)(r,[{key:"getPrettyDate",value:function(e){var t=new Date(Date.parse(e)),r=t.getDate(),n=t.getMonth(),a=t.getFullYear();return("0"+r).slice(-2)+"."+("0"+(n+1)).slice(-2)+"."+a.toString().substr(-2)}},{key:"render",value:function(){if(!this.props.rates)return a.a.createElement(Q.d,null);var e=this.getPrettyDate(this.props.rates.Date),t=this.getPrettyDate(this.props.rates.PreviousDate);return a.a.createElement(Q.j,null,a.a.createElement(Q.b,{before:a.a.createElement("div",{className:"currency_rate_dashboard__item_before"})},a.a.createElement("div",{className:"currency_rate_dashboard__item"},a.a.createElement("div",{className:"currency_rate_dashboard__item__column currency_rate_dashboard__header"},e),a.a.createElement("div",{className:"currency_rate_dashboard__item__column currency_rate_dashboard__header"},t))),this.renderRow("$",this.props.cbrCurrencies.USD),this.renderRow("\u20ac",this.props.cbrCurrencies.EUR))}},{key:"renderRow",value:function(e,t){var r=t.Value>t.Previous,n=r?"#1BEA60":"#FF0000",c=r?"\u2191":"\u2193";return a.a.createElement(Q.b,{before:a.a.createElement("div",{className:"currency_rate_dashboard__item_before"},e)},a.a.createElement("div",{className:"currency_rate_dashboard__item"},a.a.createElement("div",{className:"currency_rate_dashboard__item__column",style:{color:n}},t.Value," \u20bd ",c),a.a.createElement("div",{className:"currency_rate_dashboard__item__column"},t.Previous," \u20bd")))}}]),r}(n.Component));Object(u.b)((function(e){return{rates:g(e),cbrCurrencies:E(e)}}))(re),r(136);var ne="USD",ae="RUB",ce="EUR",oe=function(e){Object(F.a)(r,e);var t=Object(P.a)(r);function r(e){var n;return Object(N.a)(this,r),(n=t.call(this,e)).state={sourceCurrencyCode:ne,targetCurrencyCode:ae,amount:0,convertedAmount:"0"},n.changeSourceCurrencyCode=n.changeSourceCurrencyCode.bind(Object(te.a)(n)),n.changeTargetCurrencyCode=n.changeTargetCurrencyCode.bind(Object(te.a)(n)),n.changeAmount=n.changeAmount.bind(Object(te.a)(n)),n.getCurrencyRate=n.getCurrencyRate.bind(Object(te.a)(n)),n.calculateAmount=n.calculateAmount.bind(Object(te.a)(n)),n}return Object(T.a)(r,[{key:"changeSourceCurrencyCode",value:function(e){var t=this.state.targetCurrencyCode,r=e.target.value;this.state.targetCurrencyCode===e.target.value&&(t=this.state.sourceCurrencyCode),this.setState({sourceCurrencyCode:r,targetCurrencyCode:t,convertedAmount:this.calculateAmount(this.state.amount,r,t)})}},{key:"changeTargetCurrencyCode",value:function(e){var t=e.target.value,r=this.state.sourceCurrencyCode;this.state.sourceCurrencyCode===e.target.value&&(r=this.state.targetCurrencyCode),this.setState({sourceCurrencyCode:r,targetCurrencyCode:t,convertedAmount:this.calculateAmount(this.state.amount,r,t)})}},{key:"getCurrencyRate",value:function(e,t){return this.props.cbrCurrencies?e===ae?this.props.cbrCurrencies[t]?1/this.props.cbrCurrencies[t].Value:1:t===ae?this.props.cbrCurrencies[e]?this.props.cbrCurrencies[e].Value:1:t===ne?1/this.props.usdEurRate.USD_EUR.val:t===ce?this.props.usdEurRate.USD_EUR.val:1:1}},{key:"calculateAmount",value:function(e,t,r){return this.getCurrencyRate(t,r)*e}},{key:"getPrettyAmount",value:function(e){return(Math.round(e*Math.pow(10,2))/Math.pow(10,2)).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,")}},{key:"changeAmount",value:function(e){this.setState({amount:e.target.value,convertedAmount:this.calculateAmount(e.target.value,this.state.sourceCurrencyCode,this.state.targetCurrencyCode)})}},{key:"getCurrencySymbol",value:function(e){switch(e){case ne:return"$";case ce:return"\u20ac";case ae:return"\u20bd";default:return""}}},{key:"render",value:function(){return a.a.createElement(Q.d,{className:"currency_converter"},a.a.createElement("div",{style:{color:"#71757A"}},"\u041a\u0443\u0440\u0441 1 ",this.getCurrencySymbol(this.state.sourceCurrencyCode)," = ",this.getPrettyAmount(this.getCurrencyRate(this.state.sourceCurrencyCode,this.state.targetCurrencyCode))," ",this.getCurrencySymbol(this.state.targetCurrencyCode)),a.a.createElement("div",{className:"currency_converter__amount_input"},a.a.createElement("div",{className:"currency_converter__amount_input__input"},a.a.createElement(Q.h,{type:"number",placeholder:"0",pattern:"\\d*",value:this.state.amount?this.state.amount.toLocaleString():"",alignment:"right",onChange:this.changeAmount})),a.a.createElement("div",{className:"currency_converter__amount_input__selector"},a.a.createElement(Q.n,{value:this.state.sourceCurrencyCode,onChange:this.changeSourceCurrencyCode},a.a.createElement("option",{value:ne},this.getCurrencySymbol(ne)),a.a.createElement("option",{value:ce},this.getCurrencySymbol(ce)),a.a.createElement("option",{value:ae},this.getCurrencySymbol(ae))))),a.a.createElement("div",{className:"currency_converter__amount_input"},a.a.createElement("div",{className:"currency_converter__amount_input__input"},a.a.createElement(Q.h,{type:"text",alignment:"right",disabled:!0,value:this.getPrettyAmount(this.state.convertedAmount)})),a.a.createElement("div",{className:"currency_converter__amount_input__selector"},a.a.createElement(Q.n,{value:this.state.targetCurrencyCode,onChange:this.changeTargetCurrencyCode},a.a.createElement("option",{value:ne},this.getCurrencySymbol(ne)),a.a.createElement("option",{value:ce},this.getCurrencySymbol(ce)),a.a.createElement("option",{value:ae},this.getCurrencySymbol(ae))))))}}]),r}(n.Component);Object(u.b)((function(e){return{cbrCurrencies:E(e),usdEurRate:C(e)}}))(oe);var ue=new(function(){function e(){Object(N.a)(this,e)}return Object(T.a)(e,[{key:"getDaily",value:function(){var e=Object(W.a)(M.a.mark((function e(t){var r;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.getDate()+"_"+(t.getMonth()+1)+"_"+t.getFullYear(),e.abrupt("return",fetch("https://www.cbr-xml-daily.ru/daily_json.js?"+r).then((function(e){return e.json()})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}],[{key:"pad",value:function(e){return e<10?"0"+e:e}}]),e}()),ie=new(function(){function e(){Object(N.a)(this,e)}return Object(T.a)(e,[{key:"getUsdEurRate",value:function(){var e=Object(W.a)(M.a.mark((function e(){return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",fetch("https://free.currencyconverterapi.com/api/v5/convert?q=USD_EUR&compact=y&apiKey=88bb8bbba9a29716dfd5").then((function(e){return e.json()})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}());var se=function(e){Object(F.a)(r,e);var t=Object(P.a)(r);function r(){return Object(N.a)(this,r),t.apply(this,arguments)}return Object(T.a)(r,[{key:"render",value:function(){return a.a.createElement(Q.d,null,this.props.logs)}}]),r}(n.Component);Object(u.b)((function(e){return{logs:O(e)}}))(se);var le=function(e){Object(F.a)(r,e);var t=Object(P.a)(r);function r(){return Object(N.a)(this,r),t.apply(this,arguments)}return Object(T.a)(r,[{key:"componentWillMount",value:function(){this.props.dispatch(function(){var e=Object(W.a)(M.a.mark((function e(t,r){var n;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ie.getUsdEurRate();case 3:n=e.sent,t({type:"currency_rates.USD_EUR_RATE_FETCHED",daily:n}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,r){return e.apply(this,arguments)}}()),this.props.dispatch(function(){var e=Object(W.a)(M.a.mark((function e(t,r){var n,a;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=new Date,e.next=4,ue.getDaily(n);case 4:a=e.sent,t({type:"currency_rates.CBR_DAILY_FETCHED",daily:a}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,r){return e.apply(this,arguments)}}())}},{key:"render",value:function(){return a.a.createElement(Q.k,{id:this.props.id},a.a.createElement(Q.l,null,a.a.createElement("div",{style:{display:"flex",alignItems:"center"}},a.a.createElement("img",{width:"32",src:ee.a}),"\xa0\xa0\xa0\u041b\u0430\u043f\u044b \u0438 \u0445\u0432\u043e\u0441\u0442\u044b")),a.a.createElement(Q.d,{style:{height:"calc(100vh - 68px)",display:"flex",flexDirection:"column",justifyContent:"center"}},a.a.createElement(Q.d,{style:{textAlign:"center"}},a.a.createElement("h1",null,"\u0417\u0434\u0440\u0430\u0432\u0441\u0442\u0432\u0443\u0439\u0442\u0435, \u041d\u0438\u043a!"),a.a.createElement("div",{style:{marginBottom:16,fontSize:"17px",lineHeight:"20px"}},'\u0421 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435\u043c "\u041b\u0430\u043f\u044b \u0438 \u0445\u0432\u043e\u0441\u0442\u044b" \u0441\u043b\u0435\u0434\u0438\u0442\u044c \u0437\u0430 \u0437\u0434\u043e\u0440\u043e\u0432\u044c\u0435\u043c \u0412\u0430\u0448\u0435\u0433\u043e \u043f\u0438\u0442\u043e\u043c\u0446\u0430 \u043b\u0435\u0433\u043a\u043e \u0438 \u043f\u0440\u043e\u0441\u0442\u043e!'),a.a.createElement(Q.a,{size:"l"},"\u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0438\u0442\u044c"))))}}]),r}(n.Component);var he=Object(u.b)((function(e){return{notificationStatus:A(e)}}))(le),me=function(e){Object(F.a)(r,e);var t=Object(P.a)(r);function r(){return Object(N.a)(this,r),t.apply(this,arguments)}return Object(T.a)(r,[{key:"componentWillMount",value:function(){this.props.dispatch(function(){var e=Object(W.a)(M.a.mark((function e(t){return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:K.subscribe((function(e){var r=e.detail;if(r){var n=r.type,a=r.data;switch(n){case"VKWebAppUpdateInsets":t({type:"vk.insetsFetched",insets:a.insets})}}else console.error("invalid event",e)})),K.send("VKWebAppInit",{no_toolbar:!0});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}},{key:"render",value:function(){var e="about"===this.props.route.name?"aboutPanel":"mainPanel";return a.a.createElement(Q.c,{insets:this.props.insets},a.a.createElement(Q.m,{activeView:"mainView"},a.a.createElement(Q.o,{id:"mainView",activePanel:e},a.a.createElement(he,{router:this.props.router,id:"mainPanel",accessToken:this.props.accessToken}),a.a.createElement(z,{router:this.props.router,id:"aboutPanel"}))))}}]),r}(n.Component);var de=Object(u.b)((function(e){return{accessToken:k(e),insets:j(e)}}))((function(e){return a.a.createElement(i.a,{nodeName:""},(function(t){var r=t.route;return a.a.createElement(me,Object.assign({route:r},e))}))})),ve=function(){var e=Object(s.b)(m,{defaultRoute:"currency"});return e.usePlugin(l.a),e.usePlugin(Object(h.a)({useHash:!0})),e}(),pe=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=Object(R.a)(D.a,Object(S.a)(e),Object(x.createLogger)())(R.d),n=r(Object(R.c)({router:S.b,currencyRates:b,vk:w}),t);return window.store=n,n}(ve);ve.start((function(){o.a.render(a.a.createElement(u.a,{store:pe},a.a.createElement(i.b,{router:ve},a.a.createElement(de,{router:ve}))),document.getElementById("root"))})),function(){if("serviceWorker"in navigator){if(new URL(".",window.location).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat(".","/service-worker.js");U?(!function(e){fetch(e).then((function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):B(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")}))):B(e)}))}}()},57:function(e,t,r){e.exports=r.p+"static/media/logo.4c512146.svg"},58:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAABmJLR0QA/wD/AP+gvaeTAAAC7ElEQVR4nO2ZPWtUQRhGnwlIIhFRQcVKRU0CfpSJWgjqf/AbG8EuPyEqVqlEG2sbO2NQrBQ0BkEtRI0GFQQJgogBPyAWYvBY7C5cFvbOvXfeueviHNhu58wzw8zuzDtSIpFIJBKJUAAHnARmge/Nz0PgBOC67YsKsBK4Q2duAwPd8kUHmM4J22KqW76oNJdkUY7W7YsOMFci8Iu6fVEBhkuEbbG9Ll8R+kIaSxqr0GZvjT4voROwybiNtc9L6AT8qdCGGn1eQifgs3Eba5+X0Al4WqHN4xp98QFelvjFfl63LzrAsRKBj9TtqwXgZoGwN7rliw4wANzKCTtNucuQqa8WaFxfjwMzwLfm5wEVz+vWvkQZ6KViRAaT3PRaMaKJWW56qRiRwSQ3vVaMaGKWm14qRmQIye0ykiFJ70r2vcM5975C4H2SDkjarMZtbkHSrHPuSQWXTW7gdIlZbHGqZNjDwKsc3xxwqKQzKHf2NrixTMdNChcjgIuS7kralfO13ZLuAedLZAjKHXodLlSMAM5KmijYX5+kC8B4SDBfpGxnLaIUI4AxSVcruC8BoxYZCrUBhirspW15vQD9wOsK3hZv8BxeTHNjX9yYrBCunckC/djkxrAYAYwBy2VG2oFlPFvBMrdJMYLGfX6+wmA7MQ/0x86dDR9UjMBm6beTuxUscmdllYsRwCg2S7+dIluhu0UUwn/1fXj/FcoSehBqZ0LSTmNnlhFJ5yyFZtUdYL2kD5IGrZwd+CVp2Dm3YCGzXAHjij94SeqXdMZKZjkBBw1dPvZbiSy3wA9Jq618HhadcxssRJYrYJWhy0fQk3gWywn4ZOjyEfQknsVyAh4Zunw8sxJZTsA1Q5eP6zX2VYzmMXQm4imwxf1uj7UjwFZgMeLgvwBbuj3OXIA9wMcIg18A8gqq/w7AWuAKsGQw8CXgMrAmRtaoL73AoBoPICOS1klaUbDpb0lfJb1V48HkZ5yEiUQikUgkEv8xfwEwUbaImKTKGQAAAABJRU5ErkJggg=="}},[[115,1,2]]]);
//# sourceMappingURL=main.99c37910.chunk.js.map